based on [OpenEphyra](https://github.com/TScottJ/OpenEphyra)
